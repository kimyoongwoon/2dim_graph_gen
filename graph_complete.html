<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>3DIM Chart Generator</title>
    <link rel="stylesheet" href="style.css">
    <!-- Plotly.js (통합 시스템) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/plotly.js/2.26.0/plotly.min.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h2>3DIM Chart Generator</h2>
            <p>2D/3D/4D 통합 데이터 시각화 라이브러리</p>
        </div>

        <!-- 데이터 정보 표시 -->
        <div id="data-info" class="data-info">
            <strong>데이터 로딩 중...</strong>
        </div>

        <!-- 데이터 정보 표시 -->
        <div id="data-info" class="data-info">
            <strong>데이터 로딩 중...</strong>
        </div>

        <!-- Config 설정 섹션 -->
        <div class="section">
            <h4>📊 Chart Configuration Builder</h4>

            <!-- 1. Chart Type 선택 -->
            <div class="form-group">
                <label for="chartTypeSelect">
                    Chart Type <span class="text-small">(8개 타입 지원)</span>
                </label>
                <select id="chartTypeSelect">
                    <option value="">차트 타입 선택</option>
                    <optgroup label="2D Charts">
                        <option value="2d_scatter">2D Scatter Plot - X,Y 산점도</option>
                        <option value="2d_size">2D Size Chart - X축 + 크기 인코딩</option>
                        <option value="2d_color">2D Color Chart - X축 + 색상 인코딩</option>
                    </optgroup>
                    <optgroup label="3D Charts">
                        <option value="3d_surface_scatter">3D Surface + Scatter - 실제 3D (X,Y,Z)</option>
                        <option value="3d_scatter_color">3D Scatter + Color - 2D 산점도 + 색상</option>
                        <option value="3d_scatter_size">3D Scatter + Size - 2D 산점도 + 크기</option>
                        <option value="3d_size_color">3D Size + Color - 1D 위치 + 크기 + 색상</option>
                    </optgroup>
                    <optgroup label="4D Charts">
                        <option value="4d_scatter_size_color">4D Complete - 2D 산점도 + 크기 + 색상</option>
                    </optgroup>
                </select>
            </div>

            <!-- 2. Data Mapping (동적 생성) -->
            <div id="dataMappingSection" class="form-group" style="display: none;">
                <label>Data Field Mapping</label>
                <div id="dataMappingFields" class="mapping-fields">
                    <!-- 차트 타입에 따라 동적으로 생성 -->
                </div>
            </div>

            <!-- 3. Scaling Configuration -->
            <div class="form-group">
                <label for="scalingTypeSelect">Size Scaling Type</label>
                <select id="scalingTypeSelect">
                    <option value="default">Default - 기본 정규화 (0-1 → 3-18px)</option>
                    <option value="linear">Linear - 선형 변환 (y = ax + b)</option>
                    <option value="sigmoid">Sigmoid - S자 곡선 (중간값 강조)</option>
                </select>

                <!-- Scaling Parameters (동적 표시) -->
                <div id="scalingParams" style="display: none; margin-top: 10px;">
                    <!-- 파라미터 입력 필드들이 동적으로 생성 -->
                </div>
            </div>

            <!-- 4. Color Configuration -->
            <div class="form-group">
                <label for="colorTypeSelect">Color Scale</label>
                <select id="colorTypeSelect">
                    <option value="blueRed">Blue-Red - 파랑→빨강 4단계</option>
                    <option value="viridis">Viridis - 보라→파랑→녹색→노랑</option>
                    <option value="plasma">Plasma - 보라→분홍→주황→노랑</option>
                </select>
            </div>

            <!-- 5. Config 미리보기 -->
            <div class="form-group">
                <label for="configPreview">
                    Generated Config JSON <span class="text-small">(실시간 업데이트)</span>
                </label>
                <textarea id="configPreview" readonly placeholder="위 설정을 선택하면 config가 자동 생성됩니다"></textarea>
            </div>

            <!-- 검증 및 생성 -->
            <div class="controls">
                <button type="button" onclick="validateAndCreateChart()" id="createChartBtn" disabled>검증 후 차트 생성</button>
                <button type="button" onclick="resetConfiguration()" class="secondary-btn">설정 초기화</button>
                <button type="button" onclick="goBackToGenerator()" class="secondary-btn">데이터 생성으로 돌아가기</button>
            </div>
        </div>

        <!-- 검증 결과 표시 -->
        <div id="validationResult" class="validation-result hidden">
            검증 결과가 여기에 표시됩니다
        </div>

        <!-- 에러 표시 -->
        <div id="errorDisplay" class="error-display"></div>

        <!-- 사용 가능한 필드 정보 -->
        <div class="section" id="fieldsInfoSection" style="display: none;">
            <h4>📋 사용 가능한 데이터 필드</h4>
            <div id="fieldsInfo" class="text-small">
                필드 정보가 여기에 표시됩니다
            </div>
        </div>

        <!-- 차트 표시 영역 -->
        <div class="chart-container" id="chartContainer">
            <h3>통합 시각화 결과</h3>
            <div id="chartInfo" class="chart-info">차트 정보가 여기에 표시됩니다</div>
            <div class="chart-canvas-wrapper">
                <!-- 차트가 여기에 생성됩니다 -->
            </div>
        </div>
    </div>

    <script type="module" src="graph_complete.js"></script>
</body>
</html>